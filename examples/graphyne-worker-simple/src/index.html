<!DOCTYPE html>
<html>
  <head>
    <title>Graphyne Worker</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/gh/kognise/water.css@latest/dist/light.min.css"
    />
  </head>
  <body
    style="text-align: center; max-width: 860px; padding: 1rem; margin: 0 auto;"
  >
    <script src="./index.js"></script>
    <h1>Graphyne Worker example with Service Worker API</h1>
    <code>fetch('/graphql?query={hello}')</code>
    <div style="padding: 1rem;">
      <button id="query">Execute</button>
    </div>
    <h3>Result</h3>
    <textarea
      rows="8"
      cols="50"
      style="display: block; resize: none; margin: 1rem auto; padding: 2rem;"
      id="result"
    ></textarea>
    <h2>How it works?</h2>
    <p>
      After registers <code>worker.js</code> as a service worker, it will
      intercept all <code>fetch</code> events:
    </p>
    <div style="padding: 1rem;">
      <code
        style="
          display: inline-block;
          white-space: pre-wrap;
          text-align: left;
          padding: 1rem;
        "
      >
      global.addEventListener("fetch", graphyne.createHandler());      
      </code>
    </div>
    <p>
      The handler created by <code>graphyne.createHandler</code> will response
      to requests to <a href="/graphql">/graphql</a> using
      <code>
        <a
          href="https://github.com/hoangvvo/graphyne/tree/master/packages/graphyne-worker"
          >graphyne-worker</a
        >
      </code>
      locally, while those to others will pass through.
    </p>
    <p>
      If you open the developer tool and look at the Network tab, you will see that
      those requests to <a href="/graphql">/graphql</a> will have
      <br />
      <code>status code 200 <b>(from ServiceWorker)</b></code>
    </p>
  </body>
</html>
